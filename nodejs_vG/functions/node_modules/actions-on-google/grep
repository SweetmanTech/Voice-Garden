
> actions-on-google@1.7.0 test /usr/local/google/home/sachitm/Projects/assistant/client-library
> npm run lint && ./node_modules/.bin/mocha --reporter spec ./test/*.js "SACHIT"


> actions-on-google@1.7.0 lint /usr/local/google/home/sachitm/Projects/assistant/client-library
> eslint --fix "*.js" "test/*.js" "utils/*.js"



  ActionsSdkApp
    #constructor
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+1ms[0m
      âœ“ Calls sessionStarted when new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+4ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+0ms[0m
      âœ“ Does not call sessionStarted when not new session 
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+0ms[0m
      âœ“ Does not detect v2 and transform body when version not present
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+2ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+0ms[0m
      âœ“ Does detect v2 and not transform body when version is present
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Does initialize StandardIntents without an options object
    #ask
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=true, initialPrompt=<speak>Hi! <break time="1"/> I can read out an ordinal like <say-as interpret-as="ordinal">123</say-as>. Say a number.</speak>, noInputs=I didn't hear a number,If you're still there, what's the number?,What is the number? [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=<speak>Hi! <break time="1"/> I can read out an ordinal like <say-as interpret-as="ordinal">123</say-as>. Say a number.</speak>, array= [36m+1ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromSsmlHelper_: ssmls=<speak>Hi! <break time="1"/> I can read out an ordinal like <say-as interpret-as="ordinal">123</say-as>. Say a number.</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromSsmlHelper_: ssmls=I didn't hear a number,If you're still there, what's the number?,What is the number? [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt={"initialPrompts":[{"ssml":"<speak>Hi! <break time=\"1\"/> I can read out an ordinal like <say-as interpret-as=\"ordinal\">123</say-as>. Say a number.</speak>"}],"noInputPrompts":[{"ssml":"I didn't hear a number"},{"ssml":"If you're still there, what's the number?"},{"ssml":"What is the number?"}]}, dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"ssml":"<speak>Hi! <break time=\"1\"/> I can read out an ordinal like <say-as interpret-as=\"ordinal\">123</say-as>. Say a number.</speak>"}],"noInputPrompts":[{"ssml":"I didn't hear a number"},{"ssml":"If you're still there, what's the number?"},{"ssml":"What is the number?"}]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"ssml":"<speak>Hi! <break time=\"1\"/> I can read out an ordinal like <say-as interpret-as=\"ordinal\">123</say-as>. Say a number.</speak>"}],"noInputPrompts":[{"ssml":"I didn't hear a number"},{"ssml":"If you're still there, what's the number?"},{"ssml":"What is the number?"}]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"initial_prompts":[{"ssml":"<speak>Hi! <break time=\"1\"/> I can read out an ordinal like <say-as interpret-as=\"ordinal\">123</say-as>. Say a number.</speak>"}],"no_input_prompts":[{"ssml":"I didn't hear a number"},{"ssml":"If you're still there, what's the number?"},{"ssml":"What is the number?"}]},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+2ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt="What can I help you with?", dialogState=undefined [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=What can I help you with?, possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=What can I help you with? [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=What can I help you with?, noInputs=undefined [36m+3ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=What can I help you with?, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=What can I help you with? [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"What can I help you with?"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"What can I help you with?"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"initial_prompts":[{"text_to_speech":"What can I help you with?"}],"no_input_prompts":[]},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+1ms[0m
      âœ“ Should return the valid JSON in the response object for the success case when String text was asked w/o input prompts.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt="<speak>What <break time=\"1\"/> can I help you with?</speak>", dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=<speak>What <break time="1"/> can I help you with?</speak>, possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>What <break time="1"/> can I help you with?</speak> [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=true, initialPrompt=<speak>What <break time="1"/> can I help you with?</speak>, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=<speak>What <break time="1"/> can I help you with?</speak>, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromSsmlHelper_: ssmls=<speak>What <break time="1"/> can I help you with?</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromSsmlHelper_: ssmls= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"ssml":"<speak>What <break time=\"1\"/> can I help you with?</speak>"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"ssml":"<speak>What <break time=\"1\"/> can I help you with?</speak>"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"initial_prompts":[{"ssml":"<speak>What <break time=\"1\"/> can I help you with?</speak>"}],"no_input_prompts":[]},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case when SSML text was asked w/o input prompts.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=Welcome to action snippets! Say a number., noInputs=Say any number,Pick a number,What is the number? [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=Welcome to action snippets! Say a number., array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=Welcome to action snippets! Say a number. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=Say any number,Pick a number,What is the number? [32m+1ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt={"initialPrompts":[{"textToSpeech":"Welcome to action snippets! Say a number."}],"noInputPrompts":[{"textToSpeech":"Say any number"},{"textToSpeech":"Pick a number"},{"textToSpeech":"What is the number?"}]}, dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Welcome to action snippets! Say a number."}],"noInputPrompts":[{"textToSpeech":"Say any number"},{"textToSpeech":"Pick a number"},{"textToSpeech":"What is the number?"}]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Welcome to action snippets! Say a number."}],"noInputPrompts":[{"textToSpeech":"Say any number"},{"textToSpeech":"Pick a number"},{"textToSpeech":"What is the number?"}]},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"initial_prompts":[{"text_to_speech":"Welcome to action snippets! Say a number."}],"no_input_prompts":[{"text_to_speech":"Say any number"},{"text_to_speech":"Pick a number"},{"text_to_speech":"What is the number?"}]},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the advanced success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt={"speech":"hello","displayText":"hi"}, dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"richInitialPrompt":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]}},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"richInitialPrompt":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]}},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"rich_initial_prompt":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[]}},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should return the valid simple response JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt={"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}, dialogState=undefined [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=assistant.intent.action.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"richInitialPrompt":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"richInitialPrompt":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}},"possibleIntents":[{"intent":"assistant.intent.action.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"state\":null,\"data\":{}}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"rich_initial_prompt":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}},"possible_intents":[{"intent":"assistant.intent.action.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should return the valid rich response JSON in the response object for the success case.
    #tell
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+2ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=Goodbye! [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Goodbye! [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"Goodbye!"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"Goodbye!"}}}, responseCode=200 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"user_storage":"{\"data\":{}}","expect_user_response":false,"final_response":{"speech_response":{"text_to_speech":"Goodbye!"}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=[object Object] [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]}} [36m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"user_storage":"{\"data\":{}}","expect_user_response":false,"final_response":{"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[]}}} [32m+0ms[0m
      âœ“ Should return the valid simple rich response JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=[object Object] [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"user_storage":"{\"data\":{}}","expect_user_response":false,"final_response":{"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]}}} [32m+0ms[0m
      âœ“ Should return the valid rich response JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=[object Map] [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=[object Map] [32m+1ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: map [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetIntent [36m+0ms[0m
  [36;1mactions-on-google:debug [0mgetTopInput_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0minvokeIntentHandler_: handler=[object Map], intent=assistant.intent.action.MAIN [32m+0ms[0m
  [32;1mactions-on-google:debug [0mkey is id [32m+1ms[0m
  [32;1mactions-on-google:debug [0mname=intent_name_not_present_in_the_body [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=no matching intent handler for: assistant.intent.action.MAIN [32m+0ms[0m
      âœ“ Should send failure response for rich response without simple response
  [36;1mactions-on-google:debug [0mtell: textToSpeech=Sorry, I am unable to process your request. [36m+1ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Sorry, I am unable to process your request. [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"Sorry, I am unable to process your request."}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"Sorry, I am unable to process your request."}}}, responseCode=200 [32m+0ms[0m
    #getRawInput
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"bye"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetRawInput [36m+0ms[0m
  [36;1mactions-on-google:debug [0mgetTopInput_ [36m+0ms[0m
      âœ“ Should get the raw user input for the success case.
    #askWithList
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0maskWithList: inputPrompt="Here is a list", list={"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}, dialogState={"optionType":"list"} [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.OPTION [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=Here is a list, possibleIntents=[object Object],  dialogState={"optionType":"list"} [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Here is a list [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=Here is a list, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=Here is a list, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=Here is a list [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"optionType":"list"}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a list"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","listSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"optionType\":\"list\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a list"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","listSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"optionType\":\"list\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a list"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","listSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}]} [32m+0ms[0m
      âœ“ Should return the valid list JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0maskWithList: inputPrompt="Here is a list", list={"items":[]}, dialogState={"optionType":"list"} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=List requires at least 2 items [32m+0ms[0m
      âœ“ Should return the an error JSON in the response when list has <2 items.
    #askWithCarousel
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0maskWithCarousel: inputPrompt="Here is a carousel", carousel={"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}, dialogState={"optionType":"carousel"} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.OPTION [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=Here is a carousel, possibleIntents=[object Object],  dialogState={"optionType":"carousel"} [36m+1ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Here is a carousel [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=Here is a carousel, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=Here is a carousel, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=Here is a carousel [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"optionType":"carousel"}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a carousel"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","carouselSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"optionType\":\"carousel\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a carousel"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","carouselSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"optionType\":\"carousel\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"Here is a carousel"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.OPTION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","carouselSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}]}]} [32m+0ms[0m
      âœ“ Should return the valid carousel JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0maskWithList: inputPrompt="Here is a list", list={"items":[]}, dialogState={"optionType":"list"} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=List requires at least 2 items [32m+0ms[0m
      âœ“ Should return the an error JSON in the response when carousel has <2 items.
    #askForPermissions
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForPermissions: context=To get you a ride, permissions=NAME,DEVICE_PRECISE_LOCATION, dialogState={"carType":"big"} [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}, dialogState={"carType":"big"} [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_PERMISSION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_PERMISSION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"carType":"big"} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"carType":"big"}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.PERMISSION","inputValueSpec":{"permissionValueSpec":{"optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"carType\":\"big\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"assistant.intent.action.PERMISSION","inputValueSpec":{"permissionValueSpec":{"optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversation_token":"{\"carType\":\"big\"}","user_storage":"{\"data\":{}}","expect_user_response":true,"expected_inputs":[{"input_prompt":{"initial_prompts":[{"text_to_speech":"PLACEHOLDER_FOR_PERMISSION"}],"no_input_prompts":[]},"possible_intents":[{"intent":"assistant.intent.action.PERMISSION","input_value_spec":{"permission_value_spec":{"opt_context":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForPermissions: context=To get you a ride, permissions=NAME,DEVICE_PRECISE_LOCATION, dialogState={"carType":"big"} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}, dialogState={"carType":"big"} [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState={"carType":"big"} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.PERMISSION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_PERMISSION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_PERMISSION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"carType":"big"} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"carType":"big"}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"carType\":\"big\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"carType\":\"big\"}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","optContext":"To get you a ride","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case in v2.
    #askForTransactionRequirements
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mcheckForTransactionRequirements: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false}, dialogState={"cartSize":2} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK, specType=type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec, intentSpec={"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_REQUIREMENTS dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_TXN_REQUIREMENTS, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_TXN_REQUIREMENTS, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_TXN_REQUIREMENTS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON transaction requirements with Google payment options
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mcheckForTransactionRequirements: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationType":"CUSTOM STRING"}, dialogState={"cartSize":2} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationType":"CUSTOM STRING"} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK, specType=type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec, intentSpec={"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"CUSTOM STRING","parameters":{"myParam":"myParam"}}}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_REQUIREMENTS dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_TXN_REQUIREMENTS, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_TXN_REQUIREMENTS, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_TXN_REQUIREMENTS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"CUSTOM STRING","parameters":{"myParam":"myParam"}}}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"CUSTOM STRING","parameters":{"myParam":"myParam"}}}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"CUSTOM STRING","parameters":{"myParam":"myParam"}}}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON transaction requirements with Google payment options and custom tokenization type
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mcheckForTransactionRequirements: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"}, dialogState={"cartSize":2} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK, specType=type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec, intentSpec={"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_REQUIREMENTS dialogState={"cartSize":2} [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_TXN_REQUIREMENTS, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_TXN_REQUIREMENTS, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_TXN_REQUIREMENTS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON transaction requirements with Action payment options
    #askForDeliveryAddress
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDeliveryAddress: reason=Just because, dialogState=[object Object] [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DELIVERY_ADDRESS, specType=type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec, intentSpec={"addressOptions":{"reason":"Just because"}}, promptPlaceholder=PLACEHOLDER_FOR_DELIVERY_ADDRESS dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.DELIVERY_ADDRESS [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_DELIVERY_ADDRESS, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_DELIVERY_ADDRESS, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_DELIVERY_ADDRESS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DELIVERY_ADDRESS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DELIVERY_ADDRESS","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec","addressOptions":{"reason":"Just because"}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DELIVERY_ADDRESS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DELIVERY_ADDRESS","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec","addressOptions":{"reason":"Just because"}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DELIVERY_ADDRESS"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DELIVERY_ADDRESS","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec","addressOptions":{"reason":"Just because"}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON delivery address
    #askForTransactionDecision
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+1ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForTransactionDecision: order={"fakeOrderId":"order_id"}, transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false}, dialogState={"cartSize":2} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false} [32m+5ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_DECISION, specType=type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec, intentSpec={"proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_DECISION dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TRANSACTION_DECISION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_TXN_DECISION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_TXN_DECISION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_TXN_DECISION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON transaction decision with Google payment options
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForTransactionDecision: order={"fakeOrderId":"order_id"}, transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"}, dialogState={"cartSize":2} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"} [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_DECISION, specType=type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec, intentSpec={"proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_DECISION dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TRANSACTION_DECISION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_TXN_DECISION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_TXN_DECISION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_TXN_DECISION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_TXN_DECISION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TRANSACTION_DECISION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON transaction decision with Action payment options
    #askForConfirmation
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForConfirmation: prompt=You want to do that?, dialogState={"cartSize":2} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.CONFIRMATION, specType=type.googleapis.com/google.actions.v2.ConfirmationValueSpec, intentSpec={"dialogSpec":{"requestConfirmationText":"You want to do that?"}}, promptPlaceholder=PLACEHOLDER_FOR_CONFIRMATION dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.CONFIRMATION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_CONFIRMATION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_CONFIRMATION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_CONFIRMATION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec","dialogSpec":{"requestConfirmationText":"You want to do that?"}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec","dialogSpec":{"requestConfirmationText":"You want to do that?"}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec","dialogSpec":{"requestConfirmationText":"You want to do that?"}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON confirmation request
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForConfirmation: prompt=undefined, dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.CONFIRMATION, specType=type.googleapis.com/google.actions.v2.ConfirmationValueSpec, intentSpec={}, promptPlaceholder=PLACEHOLDER_FOR_CONFIRMATION dialogState=undefined [36m+1ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.CONFIRMATION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_CONFIRMATION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_CONFIRMATION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_CONFIRMATION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec"}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec"}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_CONFIRMATION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.CONFIRMATION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec"}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON confirmation request without prompt
    #askForDateTime
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=When do you want to come in?, datePrompt=What is the best date for you?, timePrompt=What time of day works best for you?, dialogState={"cartSize":2} [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={"dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.DATETIME [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_DATETIME, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_DATETIME, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=When do you want to come in?, datePrompt=null, timePrompt=undefined, dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={"dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.DATETIME [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_DATETIME, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_DATETIME, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request with partial prompts
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=undefined, datePrompt=undefined, timePrompt=undefined, dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.DATETIME [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_DATETIME, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_DATETIME, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec"}}]}], finalResponse=null [36m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec"}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_DATETIME"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.DATETIME","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec"}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request without prompts
    #askForSignIn
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForSignIn: dialogState={"cartSize":2} [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.SIGN_IN, specType=undefined, intentSpec=null, promptPlaceholder=PLACEHOLDER_FOR_SIGN_IN dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.SIGN_IN [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_SIGN_IN, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_SIGN_IN, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_SIGN_IN [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState={"cartSize":2} [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"cartSize":2}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_SIGN_IN"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.SIGN_IN","inputValueData":{}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_SIGN_IN"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.SIGN_IN","inputValueData":{}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"cartSize\":2}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_SIGN_IN"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.SIGN_IN","inputValueData":{}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON sign in request
    #askForNewSurface
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForNewSurface: context=test context, notificationTitle=test title, capabilities=["cap_one","cap_two"], dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.NEW_SURFACE, specType=type.googleapis.com/google.actions.v2.NewSurfaceValueSpec, intentSpec={"context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}, promptPlaceholder=PLACEHOLDER_FOR_NEW_SURFACE dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.NEW_SURFACE [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_NEW_SURFACE, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_NEW_SURFACE, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_NEW_SURFACE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_NEW_SURFACE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.NEW_SURFACE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.NewSurfaceValueSpec","context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_NEW_SURFACE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.NEW_SURFACE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.NewSurfaceValueSpec","context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_NEW_SURFACE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.NEW_SURFACE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.NewSurfaceValueSpec","context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON sign in request
    #getUser
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request info.
    #getUserName
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123","profile":{"display_name":"John Smith","given_name":"John","family_name":"Smith"}},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request user with sample user information.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request with undefined user information.
    #getUserLocale
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserLocale [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request user with locale.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserLocale [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for missing locale.
    #getTransactionRequirementsResult
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"extension":{"canTransact":true,"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckResult","resultType":"OK"},"name":"TRANSACTION_REQUIREMENTS_CHECK_RESULT"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetTransactionRequirementsResult [32m+0ms[0m
      âœ“ Should validate assistant request user.
    #getDeliveryAddress
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"extension":{"userDecision":"ACCEPTED","@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"TRANSACTION_DECISION_VALUE"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
      âœ“ Should validate assistant request delivery address
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"extension":{"userDecision":"ACCEPTED","@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"TRANSACTION_DECISION_VALUE"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
      âœ“ Should validate assistant request delivery address for txn decision
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"extension":{"userDecision":"REJECTED","@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"TRANSACTION_DECISION_VALUE"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
  [32;1mactions-on-google:debug [0mUser rejected giving delivery address [32m+0ms[0m
      âœ“ Should return null when user rejects
    #getTransactionDecision
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"extension":{"userDecision":"ORDER_ACCEPTED","checkResult":{"resultType":"OK","order":{"finalOrder":{"fakeOrder":"fake_order"},"googleOrderId":"goog_123","actionOrderId":"action_123","orderDate":{"seconds":40,"nanos":880000000},"paymentInfo":{"fakePayment":"fake_payment"},"customerInfo":{"email":"username@example.com"}}}},"name":"TRANSACTION_DECISION_VALUE"}]}]} [32m+1ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetTransactionDecision [32m+0ms[0m
      âœ“ Should validate assistant request delivery address
    #getUserConfirmation
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"CONFIRMATION","boolValue":true}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserConfirmation [32m+1ms[0m
      âœ“ Should validate assistant positive confirmation decision
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"CONFIRMATION","boolValue":false}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserConfirmation [32m+0ms[0m
      âœ“ Should validate assistant negative confirmation decision
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserConfirmation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get confirmation decision information [32m+0ms[0m
      âœ“ Should validate assistant missing confirmation decision
    #getDateTime
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"datetimeValue":{"date":{"month":5,"year":2017,"day":26},"time":{"hours":9}},"name":"DATETIME"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDateTime [32m+0ms[0m
      âœ“ Should validate assistant date time info
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDateTime [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get date/time information [32m+0ms[0m
      âœ“ Should validate assistant missing date time info
    #getSignInStatus
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"SIGN_IN","extension":{"@type":"type.googleapis.com/google.actions.v2.SignInValue","status":"foo_status"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSignInStatus [32m+0ms[0m
      âœ“ Should validate assistant sign in status
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSignInStatus [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get sign in status [32m+0ms[0m
      âœ“ Should validate assistant missing sign in status
    #getDeviceLocation
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"device":{"location":{"coordinates":{"latitude":37.3861,"longitude":122.0839},"formatted_address":"123 Main St, Anytown, CA 12345, United States","zip_code":"12345","city":"Anytown"}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
      âœ“ Should validate assistant request for device location when location is provided.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
      âœ“ Should validate assistant request for device location when location is undefined.
    #getAvailableSurfaces
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetAvailableSurfaces [32m+0ms[0m
      âœ“ Should return assistant available surfaces
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetAvailableSurfaces [32m+0ms[0m
      âœ“ Should return empty assistant available surfaces
    #hasAvailableSurfaceCapabilities
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one,cap_two [32m+0ms[0m
      âœ“ Should return true for set of valid capabilities
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one [32m+0ms[0m
      âœ“ Should return true for one valid capability
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one,cap_three [32m+0ms[0m
      âœ“ Should return true for set of invalid capabilities
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_five [32m+0ms[0m
      âœ“ Should return true for one invalid capability
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=undefined [32m+0ms[0m
      âœ“ Should return false for empty assistant available surfaces
    #isNewSurface
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"NEW_SURFACE","extension":{"status":"OK"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNewSurface [32m+0ms[0m
      âœ“ Should validate when new surface was accepted.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"NEW_SURFACE","extension":{"status":"DENIED"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNewSurface [32m+0ms[0m
      âœ“ Should validate when new surface was denied.
    #isPermissionGranted
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"permission_granted","text_value":"true"}]}]} [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
      âœ“ Should validate when permissions were granted.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"permission_granted","text_value":"false"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
      âœ“ Should validate when permissions were not granted.
    #isInSandbox
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"isInSandbox":true} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misInSandbox [32m+0ms[0m
      âœ“ Should validate when app is in sandbox mode.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"isInSandbox":false} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misInSandbox [32m+0ms[0m
      âœ“ Should validate when app is not in sandbox mode.
    #getRepromptCount
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"1"},{"name":"IS_FINAL_REPROMPT","textValue":"0"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetRepromptCount [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=REPROMPT_COUNT [32m+0ms[0m
      âœ“ Should return the proper reprompt count.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetRepromptCount [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=REPROMPT_COUNT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: REPROMPT_COUNT [32m+0ms[0m
      âœ“ Should return null when no reprompt count available.
    #isFinalReprompt
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"2"},{"name":"IS_FINAL_REPROMPT","textValue":"1"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return true for final reprompt
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"0"},{"name":"IS_FINAL_REPROMPT","textValue":"0"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return false for non-final reprompt
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return false when no reprompt count available.
    #hasSurfaceCapability
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"surface":{"capabilities":[{"name":"actions.capability.AUDIO_OUTPUT"},{"name":"actions.capability.SCREEN_OUTPUT"}]}} [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasSurfaceCapability: requestedCapability=actions.capability.SCREEN_OUTPUT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasSurfaceCapability: requestedCapability=MAGIC_POWERS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
      âœ“ Should return true for a valid capability from incoming JSON for the success case.
    #getSurfaceCapabilities
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}],"surface":{"capabilities":[{"name":"actions.capability.AUDIO_OUTPUT"},{"name":"actions.capability.SCREEN_OUTPUT"}]}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
      âœ“ Should return valid list of capabilities from incoming JSON for the success case.
    #getInputType
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":3,"query":"talk to action snippets"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetInputType [32m+0ms[0m
      âœ“ Should return valid input type from incoming JSON for the success case.
    #getApiVersion
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistant API version: v1 [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetApiVersion [36m+0ms[0m
      âœ“ Should validate assistant request info.
    #getDialogState
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2,"conversation_token":"{\"started\":true}"},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetDialogState [36m+0ms[0m
      âœ“ Should validate assistant dialog state info.
    #getActionVersionLabel
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetActionVersionLabel [36m+0ms[0m
      âœ“ Should validate assistant action version label info.
    #getConversationId
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"0123456789","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetConversationId [36m+0ms[0m
      âœ“ Should validate assistant conversation ID.
    #getArgument
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"number","raw_text":"45","text_value":"45"},{"name":"other_value","raw_text":"45","other_value":{"key":"value"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=number [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=other_value [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=number [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=You said 45 [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=You said 45 [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"You said 45"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"You said 45"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"user_storage":"{\"data\":{}}","expect_user_response":false,"final_response":{"speech_response":{"text_to_speech":"You said 45"}}} [32m+0ms[0m
      âœ“ Should validate assistant intent.
    #getSelectedOption
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"OPTION","text_value":"first_item"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetSelectedOption [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=OPTION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=OPTION [32m+0ms[0m
      âœ“ Should get the selected option when given in arguments
    #tell
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"45"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mgetRawInput [36m+0ms[0m
  [36;1mactions-on-google:debug [0mgetTopInput_ [36m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=<speak>You said <break time="2"/>45</speak> [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>You said <break time="2"/>45</speak> [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"ssml":"<speak>You said <break time=\"2\"/>45</speak>"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"ssml":"<speak>You said <break time=\"2\"/>45</speak>"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"user_storage":"{\"data\":{}}","expect_user_response":false,"final_response":{"speech_response":{"ssml":"<speak>You said <break time=\"2\"/>45</speak>"}}} [32m+0ms[0m
      âœ“ Should validate assistant tell SSML.
    #userStorage
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined userStorage as an empty object for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined userStorage as an empty object for live session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=hi [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"hi"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}} [32m+0ms[0m
      âœ“ Should send userStorage in response body
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"},"conversation":{"conversationId":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse userStorage from request body user data for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse userStorage from request body user data for live session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=hi [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"hi"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"userStorage":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}} [32m+0ms[0m
      âœ“ Should send userStorage if it was changed
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=hi [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"hi"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}} [32m+0ms[0m
      âœ“ Should not send userStorage if it was not changed
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=hi [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"hi"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{\"someOtherProperty\":\"someOtherValue\",\"someProperty\":\"someValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"userStorage":"{\"data\":{\"someOtherProperty\":\"someOtherValue\",\"someProperty\":\"someValue\"}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}} [32m+0ms[0m
      âœ“ Should send userStorage if its properties were reordered
    #data
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined conversationToken as an empty data object for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined conversationToken as an empty data object for live session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":1,"conversationToken":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse conversationToken as a data object for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2,"conversationToken":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse conversationToken as a data object for live session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt="hi", dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=hi, possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=hi, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=hi, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{"someProperty":"someValue"}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{\"someProperty\":\"someValue\"}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{\"someProperty\":\"someValue\"}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should send conversationToken in response body mid-dialog
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2,"conversationToken":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mask: inputPrompt="hi", dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.TEXT [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=hi, possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=hi, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=hi, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"data":{"someProperty":"test","someOtherProperty":"someOtherValue"}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"hi"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.TEXT"}]}]} [32m+0ms[0m
      âœ“ Should send modified conversationToken in response body mid-dialog
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0mtell: textToSpeech=hi [36m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken=null, expectUserResponse=false, expectedInput=null, finalResponse={"speechResponse":{"textToSpeech":"hi"}} [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"userStorage":"{\"data\":{}}","expectUserResponse":false,"finalResponse":{"speechResponse":{"textToSpeech":"hi"}}} [32m+0ms[0m
      âœ“ Should not send conversationToken in response body for dialog end
    #getLastSeen
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for empty lastSeen v2 proto3 Timestamp for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for empty lastSeen v2 proto3 Timestamp for live session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","lastSeen":"2017-10-26T23:40:59.742Z"},"conversation":{"conversationId":"1480373842830","type":1},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return a Date for lastSeen v2 proto3 Timestamp for new session
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"userId":"user123","lastSeen":"2017-10-26T23:40:59.742Z"},"conversation":{"conversationId":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","rawInputs":[{"inputType":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return a Date for lastSeen v2 proto3 Timestamp for live session
    #isRequestFromGoogle
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0misRequestFromGoogle: projectId=nodejs-cloud-test-project-1234 [36m+0ms[0m
      âœ“ Should validate the incoming auth token.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+2ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0misRequestFromGoogle: projectId=invalidProject [36m+0ms[0m
      âœ“ Should invalidate incorrect project ID.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [36;1mactions-on-google:debug [0misRequestFromGoogle: projectId=nodejs-cloud-test-project-1234 [36m+0ms[0m
      âœ“ Should invalidate header without auth token.
    #askToRegisterDailyUpdate
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=test_intent, intentArguments=[object Object], dialogState=undefined [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.REGISTER_UPDATE, specType=type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec, intentSpec={"intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}, promptPlaceholder=PLACEHOLDER_FOR_REGISTER_UPDATE dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.REGISTER_UPDATE [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_REGISTER_UPDATE, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_REGISTER_UPDATE, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_REGISTER_UPDATE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON update registration request
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=test_intent, intentArguments=undefined, dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.REGISTER_UPDATE, specType=type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec, intentSpec={"intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}, promptPlaceholder=PLACEHOLDER_FOR_REGISTER_UPDATE dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.REGISTER_UPDATE [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_REGISTER_UPDATE, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_REGISTER_UPDATE, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_REGISTER_UPDATE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_REGISTER_UPDATE"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.REGISTER_UPDATE","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}}]}]} [32m+0ms[0m
      âœ“ Should return valid JSON update registration request
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=, intentArguments=[object Object], dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Name of intent to trigger on update must be specified [32m+0ms[0m
      âœ“ Should return null
    #isUpdateRegistered
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"REGISTER_UPDATE","extension":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValue","status":"OK"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misUpdateRegistered [32m+0ms[0m
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"REGISTER_UPDATE","extension":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValue","status":"CANCELLED"}}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: permission_granted [32m+0ms[0m
      âœ“ Should validate user registration status.
    #askForUpdatePermission
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=test_intent, intentArguments=[object Object], dialogState=undefined [32m+1ms[0m
  [36;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}, dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.PERMISSION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_PERMISSION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_PERMISSION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=test_intent, intentArguments=undefined, dialogState=undefined [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}, dialogState=undefined [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildExpectedIntent_: intent=actions.intent.PERMISSION [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildInputPrompt: isSsml=false, initialPrompt=PLACEHOLDER_FOR_PERMISSION, noInputs=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mmaybeAddItemToArray_: item=PLACEHOLDER_FOR_PERMISSION, array= [36m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts= [32m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildAskHelper_: inputPrompt=[object Object], possibleIntents=[object Object],  dialogState=undefined [36m+0ms[0m
  [36;1mactions-on-google:debug [0mbuildResponseHelper_: conversationToken={"state":null,"data":{}}, expectUserResponse=true, expectedInput=[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}}]}], finalResponse=null [36m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}}]}]}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"conversationToken":"{\"state\":null,\"data\":{}}","userStorage":"{\"data\":{}}","expectUserResponse":true,"expectedInputs":[{"inputPrompt":{"initialPrompts":[{"textToSpeech":"PLACEHOLDER_FOR_PERMISSION"}],"noInputPrompts":[]},"possibleIntents":[{"intent":"actions.intent.PERMISSION","inputValueData":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}}]}]} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object without arguments for the success case.
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"user":{"user_id":"user123"},"conversation":{"conversation_id":"1480373842830","type":2},"inputs":[{"intent":"assistant.intent.action.MAIN","raw_inputs":[{"input_type":2,"query":"talk to hello action"}],"arguments":[{"name":"agent_info"}]}]} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [36;1mactions-on-google:debug [0mextractData_ [36m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=, intentArguments=[object Object], dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Name of intent to trigger on update must be specified [32m+0ms[0m
      âœ“ Should return null
    #getProfile
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Response can NOT be empty. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetProfile: projectId=nodejs-cloud-test-project-1234 [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should reject when the ID Token is missing
SACHIT********+++++++______***%$%$%$%$%A#&$
undefined
  [36;1mactions-on-google:debug [0mActionsSdkApp constructor [36m+2ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Response can NOT be empty. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetProfile: projectId=invalidId [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
      âœ“ Should reject when the verification fails
      1) Should resolve when the ID Token is present
      2) Should resolve immediately when called >1 times

  AssistantApp
    #isNotApiVersionOne_
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+3ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should detect Proto2 when header isn't present
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 1 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should detect v1 when header is present
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"originalRequest":{"version":1}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 1 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should detect v2 when version is present in DialogflowApp req
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should detect v2 when header is present
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"originalRequest":{"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should detect v2 when version is present in DialogflowApp req
    #isSsml_
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<SPEAK></SPEAK> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=  <speak></speak>   [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>  </speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak version="1.0"></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak version="1.0">Hello world!</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text= [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=bla bla bla [32m+1ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<html></html> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=bla bla bla<speak></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak></speak> bla bla bla [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>my SSML content</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>Line 1
Line 2</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak>Step 1, take a deep breath. <break time="2s" />Step 2, exhale.</speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="cardinal">12345</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="ordinal">1</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="characters">can</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="date" format="ymd">1960-09-10</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="date" format="yyyymmdd" detail="1">1960-09-10</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="date" format="dm">10-9</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="date" format="dmy" detail="2">10-9-1960</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><say-as interpret-as="time" format="hms12">2:30pm</say-as></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><audio src="https://somesite.bla/meow.mp3">a cat meowing</audio></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><p><s>This is sentence one.</s><s>This is sentence two.</s></p></speak> [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=<speak><sub alias="World Wide Web Consortium">W3C</sub></speak> [32m+0ms[0m
      âœ“ Should validate SSML syntax.
    #handleRequestAsync
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+1ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=[object Map] [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: map [32m+0ms[0m
  [32;1mactions-on-google:debug [0minvokeIntentHandler_: handler=[object Map], intent=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mkey is id [32m+0ms[0m
  [32;1mactions-on-google:debug [0mname=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mmap of intents [32m+0ms[0m
  [32;1mactions-on-google:debug [0msuccess [32m+0ms[0m
      âœ“ Should resolve a promise when actionMap contains a handler that returns a promise
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=[object Map] [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: map [32m+0ms[0m
  [32;1mactions-on-google:debug [0minvokeIntentHandler_: handler=[object Map], intent=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mkey is id [32m+0ms[0m
  [32;1mactions-on-google:debug [0mname=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mmap of intents [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=intent handler failed: %s [32m+0ms[0m
      âœ“ Should reject a promise when actionMap contains a handler that returns a promise error
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=app => {
        return Promise.resolve('success');
      } [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: function [32m+0ms[0m
  [32;1mactions-on-google:debug [0msuccess [32m+1ms[0m
      âœ“ Should resolve a promise when handler function returns a promise
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=app => {
        return Promise.reject(new Error('error'));
      } [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: function [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=function failed: %s [32m+0ms[0m
      âœ“ Should reject a promise when handler function returns a promise error
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=app => {
        return 'success';
      } [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: function [32m+0ms[0m
      âœ“ Should resolve a promise when handler function does not return a promise
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractData_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=[object Map] [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: map [32m+0ms[0m
  [32;1mactions-on-google:debug [0minvokeIntentHandler_: handler=[object Map], intent=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mkey is id [32m+0ms[0m
  [32;1mactions-on-google:debug [0mname=greetings [32m+0ms[0m
  [32;1mactions-on-google:debug [0mmap of intents [32m+0ms[0m
  [32;1mactions-on-google:debug [0msuccess [32m+0ms[0m
      âœ“ Should resolve a promise when actionMap contains a handler that does not return a promise

  DialogflowApp
    #constructor
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+0ms[0m
      âœ“ Calls sessionStarted when new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequest: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleRequestAsync: handler=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=request handler can NOT be empty. [32m+0ms[0m
      âœ“ Does not call sessionStarted when not new session 
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Does initialize StandardIntents without an options object
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana","foo_param":"blue"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0,"foo_message":"bar_val"}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"foo_prop":"bar_val"},"foo_field":"bar_val"} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Does not detect v2 and transform originalRequest when version not present
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana","foo_param":"blue"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0,"foo_message":"bar_val"}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"foo_prop":"bar_val","version":"2"},"foo_field":"bar_val"} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Does detect v2 and not transform originalRequest when version is present
    #tell
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hello [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hello, expectUserResponse=false, noInputs=undefined [31m+1ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hello [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[],"data":{"google":{"expect_user_response":false,"no_input_prompts":[],"is_ssml":false,"user_storage":"{\"data\":{}}"}}} [32m+1ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=[object Object] [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[],"data":{"google":{"expect_user_response":false,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid simple response JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=[object Object] [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=false, noInputs=undefined [31m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[],"data":{"google":{"expect_user_response":false,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid rich response JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=[object Object] [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"<speak>hi</speak>","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"ssml":"<speak>hi</speak>","displayText":"hi"}}],"suggestions":[]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"<speak>hi</speak>","contextOut":[],"data":{"google":{"expect_user_response":false,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"ssml":"<speak>hi</speak>","display_text":"hi"}}],"suggestions":[]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should set response speech when SSML is contained in simple response
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=[object Object] [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response=null, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Response can NOT be empty. [32m+0ms[0m
      âœ“ Should send failure response for rich response without simple response
    #ask
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=hello, noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hello, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hello [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"is_ssml":false,"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid speech JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=[object Object], noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid simple response JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=[object Object], noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid rich response JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=hello, noInputs=no,input,prompts [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hello, expectUserResponse=true, noInputs=no,input,prompts [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hello [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=no,input,prompts [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hello [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[{"textToSpeech":"no"},{"textToSpeech":"input"},{"textToSpeech":"prompts"}],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[{"text_to_speech":"no"},{"text_to_speech":"input"},{"text_to_speech":"prompts"}],"is_ssml":false,"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return no input prompts with a simple response
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=[object Object], noInputs=no,input,prompts [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=true, noInputs=no,input,prompts [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=[object Object] [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=no,input,prompts [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[{"textToSpeech":"no"},{"textToSpeech":"input"},{"textToSpeech":"prompts"}],"richResponse":{"items":[{"simpleResponse":{"textToSpeech":"hello","displayText":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hello","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[{"text_to_speech":"no"},{"text_to_speech":"input"},{"text_to_speech":"prompts"}],"rich_response":{"items":[{"simple_response":{"text_to_speech":"hello","display_text":"hi"}}],"suggestions":[{"title":"Say this"},{"title":"or this"}]},"user_storage":"{\"data\":{}}"}}} [32m+1ms[0m
      âœ“ Should return no input prompts with a rich response
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=[object Object], noInputs=undefined [31m+1ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"<speak>hi</speak>","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"richResponse":{"items":[{"simpleResponse":{"ssml":"<speak>hi</speak>","displayText":"hi"}}],"suggestions":[]},"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"<speak>hi</speak>","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"rich_response":{"items":[{"simple_response":{"ssml":"<speak>hi</speak>","display_text":"hi"}}],"suggestions":[]},"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should set response speech when SSML is contained in simple response
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=[object Object], noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=[object Object], expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Error in building response [32m+0ms[0m
      âœ“ Should send failure response for rich response without simple response
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=hello, noInputs=too,many,no input,prompts [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hello, expectUserResponse=true, noInputs=too,many,no input,prompts [31m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Error in building response [32m+0ms[0m
      âœ“ Should send failure response for no input prompts with more than 3 items
    #askWithList
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}},"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0maskWithList: inputPrompt=Here is a list, list={"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]} [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=Here is a list, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Here is a list [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"Here is a list","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.OPTION","data":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","listSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"Here is a list","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.OPTION","data":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","listSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}}}} [32m+0ms[0m
      âœ“ Should return the valid list JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}},"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0maskWithList: inputPrompt=Here is a list, list={"items":[]} [31m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=List requires at least 2 items [32m+0ms[0m
      âœ“ Should return the an error JSON in the response when list has <2 items.
    #askWithCarousel
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}},"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0maskWithCarousel: inputPrompt=Here is a carousel, carousel={"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]} [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=Here is a carousel, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Here is a carousel [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"Here is a carousel","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.OPTION","data":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","carouselSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"Here is a carousel","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.OPTION","data":{"@type":"type.googleapis.com/google.actions.v2.OptionValueSpec","carouselSelect":{"items":[{"optionInfo":{"key":"key_1","synonyms":["key one"]},"title":""},{"optionInfo":{"key":"key_2","synonyms":["key two"]},"title":""}]}}}}}} [32m+0ms[0m
      âœ“ Should return the valid carousel JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+6ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}},"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0maskWithCarousel: inputPrompt=Here is a carousel, carousel={"items":[]} [31m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Carousel requires at least 2 items [32m+0ms[0m
      âœ“ Should return the an error JSON in the response when carousel has <2 items.
    #askForPermissions
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForPermissions: context=To test, permissions=NAME,DEVICE_PRECISE_LOCATION, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]} [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_PERMISSION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"assistant.intent.action.PERMISSION","spec":{"permissionValueSpec":{"optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"is_ssml":false,"user_storage":"{\"data\":{}}","system_intent":{"intent":"assistant.intent.action.PERMISSION","spec":{"permission_value_spec":{"opt_context":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
    #askForPermissions
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}},"version":2}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from Dialogflow: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForPermissions: context=To test, permissions=NAME,DEVICE_PRECISE_LOCATION, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]} [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_PERMISSION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","optContext":"To test","permissions":["NAME","DEVICE_PRECISE_LOCATION"]}}}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
    #getUser
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"11112226094657824893","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request user.
    #getUserName
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"11112226094657824893","profile":{"display_name":"John Smith","given_name":"John","family_name":"Smith"}},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"11112226094657824893"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserName [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request user.
    #getUserLocale
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserLocale [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should validate assistant request user with locale.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserLocale [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for missing locale.
    #getDeviceLocation
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"device":{"location":{"coordinates":{"latitude":37.3861,"longitude":122.0839},"formatted_address":"123 Main St, Anytown, CA 12345, United States","zip_code":"12345","city":"Anytown"}}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
      âœ“ Should validate assistant request user.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeviceLocation [32m+0ms[0m
      âœ“ Should validate faulty assistant request user.
    #getTransactionRequirementsResult
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"extension":{"canTransact":true,"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckResult","resultType":"OK"},"name":"TRANSACTION_REQUIREMENTS_CHECK_RESULT"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetTransactionRequirementsResult [32m+0ms[0m
      âœ“ Should validate assistant request transaction result.
    #getDeliveryAddress
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"extension":{"userDecision":"ACCEPTED","@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"DELIVERY_ADDRESS_VALUE"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
      âœ“ Should validate assistant request delivery address
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"extension":{"userDecision":"ACCEPTED","@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"TRANSACTION_DECISION_VALUE"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
      âœ“ Should validate assistant request delivery address for txn decision
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"extension":{"userDecision":"REJECTED","@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValue","location":{"zipCode":"94043","postalAddress":{"regionCode":"US","recipients":["Jane Smith"],"postalCode":"94043","locality":"Mountain View","addressLines":["1600 Amphitheatre Parkway"],"administrativeArea":"CA"},"phoneNumber":"+1 415-555-1234","city":"Mountain View"}},"name":"DELIVERY_ADDRESS_VALUE"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDeliveryAddress [32m+0ms[0m
  [32;1mactions-on-google:debug [0mUser rejected giving delivery address [32m+0ms[0m
      âœ“ Should return null when user rejects
    #getTransactionDecision
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"extension":{"userDecision":"ORDER_ACCEPTED","checkResult":{"resultType":"OK","order":{"finalOrder":{"fakeOrder":"fake_order"},"googleOrderId":"goog_123","actionOrderId":"action_123","orderDate":{"seconds":40,"nanos":880000000},"paymentInfo":{"fakePayment":"fake_payment"},"customerInfo":{"email":"username@example.com"}}}},"name":"TRANSACTION_DECISION_VALUE"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetTransactionDecision [32m+0ms[0m
      âœ“ Should validate assistant request delivery address
    #getUserConfirmation
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"CONFIRMATION","boolValue":true}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserConfirmation [32m+0ms[0m
      âœ“ Should validate assistant request positive user confirmation
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"CONFIRMATION","boolValue":false}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUserConfirmation [32m+0ms[0m
      âœ“ Should validate assistant request negative user confirmation
    #getDateTime
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"datetimeValue":{"date":{"month":5,"year":2017,"day":26},"time":{"hours":9}},"name":"DATETIME"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDateTime [32m+0ms[0m
      âœ“ Should validate assistant datetime information
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetDateTime [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get date/time information [32m+0ms[0m
      âœ“ Should validate assistant request missing date/time information
    #getSignInStatus
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"SIGN_IN","extension":{"@type":"type.googleapis.com/google.actions.v2.SignInValue","status":"foo_status"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetSignInStatus [32m+0ms[0m
      âœ“ Should validate assistant sign in status
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSignInStatus [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get sign in status [32m+0ms[0m
      âœ“ Should validate assistant request missing sign in status
    #getAvailableSurfaces
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetAvailableSurfaces [32m+0ms[0m
      âœ“ Should return assistant available surfaces
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetAvailableSurfaces [32m+0ms[0m
      âœ“ Should return empty assistant available surfaces
    #hasAvailableSurfaceCapabilities
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one,cap_two [32m+0ms[0m
      âœ“ Should return true for set of valid capabilities
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one [32m+0ms[0m
      âœ“ Should return true for one valid capability
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_one,cap_three [32m+0ms[0m
      âœ“ Should return false for set of invalid capabilities
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=cap_five [32m+0ms[0m
      âœ“ Should return false for one invalid capability
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"availableSurfaces":[{"capabilities":[{"name":"cap_one"},{"name":"cap_two"}]},{"capabilities":[{"name":"cap_three"},{"name":"cap_four"}]}]}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasAvailableSurfaceCapabilities: capabilities=undefined [32m+0ms[0m
      âœ“ Should return false for empty assistant available surfaces
    #askForTransactionRequirements
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mcheckForTransactionRequirements: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false}, dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false} [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK, specType=type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec, intentSpec={"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_REQUIREMENTS dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_TXN_REQUIREMENTS, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_TXN_REQUIREMENTS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON transaction requirements with Google payment options
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mcheckForTransactionRequirements: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"}, dialogState=undefined [32m+1ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773"} [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_REQUIREMENTS_CHECK, specType=type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec, intentSpec={"orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_REQUIREMENTS dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_TXN_REQUIREMENTS, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_TXN_REQUIREMENTS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_TXN_REQUIREMENTS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_REQUIREMENTS_CHECK","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionRequirementsCheckSpec","orderOptions":{"requestDeliveryAddress":true},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON transaction requirements with Action payment options
    #askForDeliveryAddress
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDeliveryAddress: reason=Just because, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DELIVERY_ADDRESS, specType=type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec, intentSpec={"addressOptions":{"reason":"Just because"}}, promptPlaceholder=PLACEHOLDER_FOR_DELIVERY_ADDRESS dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_DELIVERY_ADDRESS, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_DELIVERY_ADDRESS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_DELIVERY_ADDRESS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DELIVERY_ADDRESS","data":{"@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec","addressOptions":{"reason":"Just because"}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_DELIVERY_ADDRESS","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DELIVERY_ADDRESS","data":{"@type":"type.googleapis.com/google.actions.v2.DeliveryAddressValueSpec","addressOptions":{"reason":"Just because"}}}}}} [32m+1ms[0m
      âœ“ Should return valid JSON delivery address
    #askForTransactionDecision
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForTransactionDecision: order={"fakeOrderId":"order_id"}, transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"customerInfoOptions":["EMAIL"]}, dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"tokenizationParameters":{"myParam":"myParam"},"cardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"customerInfoOptions":["EMAIL"]} [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_DECISION, specType=type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec, intentSpec={"proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_DECISION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_TXN_DECISION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_TXN_DECISION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_TXN_DECISION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_DECISION","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_TXN_DECISION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_DECISION","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"googleProvidedOptions":{"supportedCardNetworks":["VISA","MASTERCARD"],"prepaidCardDisallowed":false,"tokenizationParameters":{"tokenizationType":"PAYMENT_GATEWAY","parameters":{"myParam":"myParam"}}}}}}}}} [32m+1ms[0m
      âœ“ Should return valid JSON transaction decision with Google payment options
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForTransactionDecision: order={"fakeOrderId":"order_id"}, transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773","customerInfoOptions":["EMAIL"]}, dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: transactionConfig={"deliveryAddressRequired":true,"type":"BANK","displayName":"Checking-4773","customerInfoOptions":["EMAIL"]} [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.TRANSACTION_DECISION, specType=type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec, intentSpec={"proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}, promptPlaceholder=PLACEHOLDER_FOR_TXN_DECISION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_TXN_DECISION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_TXN_DECISION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+1ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_TXN_DECISION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_DECISION","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_TXN_DECISION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.TRANSACTION_DECISION","data":{"@type":"type.googleapis.com/google.actions.v2.TransactionDecisionValueSpec","proposedOrder":{"fakeOrderId":"order_id"},"orderOptions":{"requestDeliveryAddress":true,"customerInfoOptions":["EMAIL"]},"paymentOptions":{"actionProvidedOptions":{"paymentType":"BANK","displayName":"Checking-4773"}}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON transaction decision with Action payment options
    #askForConfirmation
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForConfirmation: prompt=You want to do that?, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.CONFIRMATION, specType=type.googleapis.com/google.actions.v2.ConfirmationValueSpec, intentSpec={"dialogSpec":{"requestConfirmationText":"You want to do that?"}}, promptPlaceholder=PLACEHOLDER_FOR_CONFIRMATION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_CONFIRMATION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_CONFIRMATION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_CONFIRMATION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.CONFIRMATION","data":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec","dialogSpec":{"requestConfirmationText":"You want to do that?"}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_CONFIRMATION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.CONFIRMATION","data":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec","dialogSpec":{"requestConfirmationText":"You want to do that?"}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON confirmation request
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForConfirmation: prompt=undefined, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.CONFIRMATION, specType=type.googleapis.com/google.actions.v2.ConfirmationValueSpec, intentSpec={}, promptPlaceholder=PLACEHOLDER_FOR_CONFIRMATION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_CONFIRMATION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_CONFIRMATION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_CONFIRMATION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.CONFIRMATION","data":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec"}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_CONFIRMATION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.CONFIRMATION","data":{"@type":"type.googleapis.com/google.actions.v2.ConfirmationValueSpec"}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON confirmation request without prompt
    #askForDateTime
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=When do you want to come in?, datePrompt=What is the best date for you?, timePrompt=What time of day works best for you?, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={"dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_DATETIME, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?","requestDateText":"What is the best date for you?","requestTimeText":"What time of day works best for you?"}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=When do you want to come in?, datePrompt=null, timePrompt=undefined, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={"dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_DATETIME, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec","dialogSpec":{"requestDatetimeText":"When do you want to come in?"}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request with partial prompts
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForDateTime: initialPrompt=undefined, datePrompt=undefined, timePrompt=undefined, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.DATETIME, specType=type.googleapis.com/google.actions.v2.DateTimeValueSpec, intentSpec={}, promptPlaceholder=PLACEHOLDER_FOR_DATETIME dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_DATETIME, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_DATETIME [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec"}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_DATETIME","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.DATETIME","data":{"@type":"type.googleapis.com/google.actions.v2.DateTimeValueSpec"}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON datetime request withouts prompt
    #askForSignIn
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForSignIn: dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.SIGN_IN, specType=undefined, intentSpec=null, promptPlaceholder=PLACEHOLDER_FOR_SIGN_IN dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_SIGN_IN, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_SIGN_IN [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_SIGN_IN","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.SIGN_IN","data":{}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_SIGN_IN","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.SIGN_IN","data":{}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON sign in request
    #askForNewSurface
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForNewSurface: context=test context, notificationTitle=test title, capabilities=["cap_one","cap_two"], dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.NEW_SURFACE, specType=type.googleapis.com/google.actions.v2.NewSurfaceValueSpec, intentSpec={"context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}, promptPlaceholder=PLACEHOLDER_FOR_NEW_SURFACE dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_NEW_SURFACE, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_NEW_SURFACE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_NEW_SURFACE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.NEW_SURFACE","data":{"@type":"type.googleapis.com/google.actions.v2.NewSurfaceValueSpec","context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_NEW_SURFACE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.NEW_SURFACE","data":{"@type":"type.googleapis.com/google.actions.v2.NewSurfaceValueSpec","context":"test context","notificationTitle":"test title","capabilities":["cap_one","cap_two"]}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON sign in request
    #isNewSurface
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"NEW_SURFACE","extension":{"status":"OK"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNewSurface [32m+0ms[0m
      âœ“ Should validate when new surface was accepted.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"NEW_SURFACE","extension":{"status":"DENIED"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNewSurface [32m+0ms[0m
      âœ“ Should validate when new surface was denied.
    #isPermissionGranted
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"permission_granted","text_value":"true"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"permission_granted","text_value":false}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should validate assistant request user.
    #isInSandbox
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"isInSandbox":true}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misInSandbox [32m+0ms[0m
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"isInSandbox":false}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misInSandbox [32m+0ms[0m
      âœ“ Should validate assistant request user.
    #getRepromptCount
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"1"},{"name":"IS_FINAL_REPROMPT","textValue":"0"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetRepromptCount [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=REPROMPT_COUNT [32m+0ms[0m
      âœ“ Should return the proper reprompt count.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetRepromptCount [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=REPROMPT_COUNT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: REPROMPT_COUNT [32m+0ms[0m
      âœ“ Should return null when no reprompt count available.
    #isFinalReprompt
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"2"},{"name":"IS_FINAL_REPROMPT","textValue":"1"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return true for final reprompt
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"intent":"actions.intent.NO_INPUT","arguments":[{"name":"REPROMPT_COUNT","textValue":"0"},{"name":"IS_FINAL_REPROMPT","textValue":"0"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return false for non-final reprompt
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misFinalReprompt [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=IS_FINAL_REPROMPT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: IS_FINAL_REPROMPT [32m+0ms[0m
      âœ“ Should return false when no reprompt count available.
    #getIntent
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"check_guess","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetIntent [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetIntent_ [31m+1ms[0m
      âœ“ Should get the intent value for the success case.
    #getArgument
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana","guess":"50"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"raw_text":"raw text one","text_value":"text value one","name":"arg_value_one"},{"name":"other_value","raw_text":"45","other_value":{"key":"value"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetArgument: argName=guess [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetArgument: argName=arg_value_one [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=arg_value_one [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetArgument: argName=other_value [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=other_value [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
      âœ“ Should get the argument value for the success case.
    #getContextArgument
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"game","parameters":{"guess.original":"50","guess":"50"},"lifespan":5},{"name":"previous_answer","parameters":{"answer":"68","guess.original":"51","guess":"50"},"lifespan":99}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=game, argName=guess [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=previous_answer, argName=answer [31m+1ms[0m
      âœ“ Should get the context argument value for the success case.
    #getIncomingRichResponse
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"type":"simple_response","platform":"google","textToSpeech":"Simple response one"},{"type":"basic_card","platform":"google","formattedText":"my text","buttons":[]},{"type":"suggestion_chips","platform":"google","suggestions":[{"title":"suggestion one"}]},{"type":"link_out_chip","platform":"google","destinationName":"google","url":"google.com"},{"type":0,"speech":"Good day!"}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetIncomingRichResponse [31m+1ms[0m
      âœ“ Should get the incoming rich response for the success case.
    #getIncomingList
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0},{"type":"list_card","platform":"google","title":"list_title","items":[{"optionInfo":{"key":"first_item","synonyms":[]},"title":"first item"},{"optionInfo":{"key":"second_item","synonyms":[]},"title":"second item"}]}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetIncomingList [31m+0ms[0m
      âœ“ Should get the incoming list for the success case.
    #getIncomingCarousel
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0},{"type":"carousel_card","platform":"google","items":[{"optionInfo":{"key":"first_item","synonyms":[]},"title":"first item","description":"Your first choice"},{"optionInfo":{"key":"second_item","synonyms":[]},"title":"second item","description":"Your second choice"}]}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetIncomingCarousel [31m+0ms[0m
      âœ“ Should get the incoming list for the success case.
    #getSelectedOption
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"actions_intent_option","parameters":{"OPTION":"first_item"},"lifespan":0}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"arguments":[{"text_value":"first_item","name":"OPTION"}],"intent":"actions.intent.OPTION","raw_inputs":[{"query":"firstitem","input_type":2,"annotation_sets":[]}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetSelectedOption [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=actions_intent_option, argName=OPTION [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=actions_intent_option, argName=OPTION [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=actions_intent_option, argName=OPTION [31m+0ms[0m
      âœ“ Should get the selected option when given in Dialogflow context.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"arguments":[{"text_value":"first_item","name":"OPTION"}],"intent":"actions.intent.OPTION","raw_inputs":[{"query":"firstitem","input_type":2,"annotation_sets":[]}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetSelectedOption [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContextArgument: contextName=actions_intent_option, argName=OPTION [31m+0ms[0m
  [31;1mactions-on-google:debug [0mFailed to get context argument value: OPTION [31m+0ms[0m
  [31;1mactions-on-google:debug [0mgetArgument: argName=OPTION [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=OPTION [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetArgument: argName=OPTION [31m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=OPTION [32m+0ms[0m
      âœ“ Should get the selected option when not given in Dialogflow context.
    #isRequestFromDialogflow
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0misRequestFromDialogflow: key=Google-Assistant-Signature, value=YOUR_PRIVATE_KEY [31m+0ms[0m
      âœ“ Should confirm request is from Dialogflow.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0misRequestFromDialogflow: key=Google-Assistant-Signature, value=YOUR_PRIVATE_KEY [31m+0ms[0m
      âœ“ Should confirm request is NOT from Dialogflow.
    #hasSurfaceCapability
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"surface":{"capabilities":[{"name":"actions.capability.AUDIO_OUTPUT"},{"name":"actions.capability.SCREEN_OUTPUT"}]}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasSurfaceCapability: requestedCapability=actions.capability.SCREEN_OUTPUT [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhasSurfaceCapability: requestedCapability=MAGIC_POWERS [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
      âœ“ Should return true for a valid capability from incoming JSON for the success case.
    #getSurfaceCapabilities
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"},"surface":{"capabilities":[{"name":"actions.capability.AUDIO_OUTPUT"},{"name":"actions.capability.SCREEN_OUTPUT"}]}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetSurfaceCapabilities [32m+0ms[0m
      âœ“ Should return valid list of capabilities from incoming JSON for the success case.
    #getInputType
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"input_type":3}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetInputType [32m+0ms[0m
      âœ“ Should return valid input type from incoming JSON for the success case.
    #getRawInput
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"is it 667","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetRawInput [31m+0ms[0m
      âœ“ Should raw input from Dialogflow.
    #setContext
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0msetContext: context=number, lifespan=NaN, parameters=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=Welcome to action snippets! Say a number., noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=Welcome to action snippets! Say a number., expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Welcome to action snippets! Say a number. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"Welcome to action snippets! Say a number.","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}},{"name":"number","lifespan":1}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"Welcome to action snippets! Say a number.","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}},{"name":"number","lifespan":1}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[],"is_ssml":false,"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
    #getContexts
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google_"},{"name":"number","lifespan":5,"parameters":{"parameterOne":"23","parameterTwo":"24"}},{"name":"word","lifespan":1,"parameters":{"parameterOne":"wordOne","parameterTwo":"wordTwo"}}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContexts [31m+0ms[0m
      âœ“ Should return the active contexts from incoming JSON for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google_"}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContexts [31m+0ms[0m
      âœ“ Should return the active contexts from incoming JSON when only app.data incoming
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContexts [31m+0ms[0m
      âœ“ Should return the active contexts from incoming JSON when no contexts provided.
    #getContext
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"number","lifespan":5,"parameters":{"parameterOne":"23","parameterTwo":"24"}}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContext: name=number [31m+0ms[0m
      âœ“ Should return the context by name from incoming JSON for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mgetContext: name=name [31m+0ms[0m
  [31;1mactions-on-google:debug [0mFailed to get context: name [31m+1ms[0m
      âœ“ Should return the context by name from incoming JSON when no context provided.
    #ask
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=Welcome to action snippets! Say a number., noInputs=Say any number,Pick a number,What is the number? [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=Welcome to action snippets! Say a number., expectUserResponse=true, noInputs=Say any number,Pick a number,What is the number? [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Welcome to action snippets! Say a number. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mbuildPromptsFromPlainTextHelper_: plainTexts=Say any number,Pick a number,What is the number? [32m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=Welcome to action snippets! Say a number. [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"Welcome to action snippets! Say a number.","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[{"textToSpeech":"Say any number"},{"textToSpeech":"Pick a number"},{"textToSpeech":"What is the number?"}],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"Welcome to action snippets! Say a number.","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expect_user_response":true,"no_input_prompts":[{"text_to_speech":"Say any number"},{"text_to_speech":"Pick a number"},{"text_to_speech":"What is the number?"}],"is_ssml":false,"user_storage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
    #userStorage
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined userStorage as an empty object for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined userStorage as an empty object for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hi [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"}}} [32m+0ms[0m
      âœ“ Should send userStorage in response body
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse userStorage from request body user data for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","userStorage":"{\"data\":{\"someProperty\":\"someValue\"}}"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse userStorage from request body user data for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hi [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someProperty\":\"test\",\"someOtherProperty\":\"someOtherValue\"}}"}}} [32m+0ms[0m
      âœ“ Should send userStorage if it was changed
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hi [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false}}} [32m+0ms[0m
      âœ“ Should not send userStorage if it was not changed
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","userStorage":"{\"data\":{\"someProperty\":\"someValue\",\"someOtherProperty\":\"someOtherValue\"}}"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hi [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someOtherProperty\":\"someOtherValue\",\"someProperty\":\"someValue\"}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{\"someOtherProperty\":\"someOtherValue\",\"someProperty\":\"someValue\"}}"}}} [32m+0ms[0m
      âœ“ Should send userStorage if its properties were reordered
    #data
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined AoG context as an empty data object for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined AoG context as an empty data object for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google"}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse undefined AoG context parameters as an empty data object for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google_","parameters":{"someProperty":"someValue","someOtherProperty":"someOtherValue"}}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse AoG context as a data object for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google_","parameters":{"someProperty":"someValue","someOtherProperty":"someOtherValue"}}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should parse AoG context as a data object for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=hi, noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{"someProperty":"someValue"}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{"someProperty":"someValue"}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should send AoG context in response body mid-dialog
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[{"name":"_actions_on_google_","parameters":{"someProperty":"someValue","someOtherProperty":"someOtherValue"}}],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mask: inputPrompt=hi, noInputs=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{"someProperty":"test","someOtherProperty":"someOtherValue"}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{"someProperty":"test","someOtherProperty":"someOtherValue"}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should send modified AoG context in response body mid-dialog
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [31;1mactions-on-google:debug [0mtell: speechResponse=hi [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=hi, expectUserResponse=false, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=hi [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"hi","contextOut":[],"data":{"google":{"expectUserResponse":false,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}"}}} [32m+0ms[0m
      âœ“ Should send empty AoG context in response body for dialog end
    #getLastSeen
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+1ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for empty lastSeen v2 proto3 Timestamp for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return null for empty lastSeen v2 proto3 Timestamp for live session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","lastSeen":"2017-10-26T23:40:59.742Z"},"conversation":{"conversation_id":"0123456789","type":1,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return a Date for lastSeen v2 proto3 Timestamp for new session
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US","lastSeen":"2017-10-26T23:40:59.742Z"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetLastSeen [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
      âœ“ Should return a Date for lastSeen v2 proto3 Timestamp for live session
    #askToRegisterDailyUpdate
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=test_intent, intentArguments=[object Object], dialogState=undefined [32m+1ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.REGISTER_UPDATE, specType=type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec, intentSpec={"intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}, promptPlaceholder=PLACEHOLDER_FOR_REGISTER_UPDATE dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_REGISTER_UPDATE, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_REGISTER_UPDATE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_REGISTER_UPDATE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.REGISTER_UPDATE","data":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_REGISTER_UPDATE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.REGISTER_UPDATE","data":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}},"arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON update registration request
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+1ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=test_intent, intentArguments=undefined, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.REGISTER_UPDATE, specType=type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec, intentSpec={"intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}, promptPlaceholder=PLACEHOLDER_FOR_REGISTER_UPDATE dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_REGISTER_UPDATE, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_REGISTER_UPDATE [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_REGISTER_UPDATE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.REGISTER_UPDATE","data":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_REGISTER_UPDATE","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.REGISTER_UPDATE","data":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValueSpec","intent":"test_intent","triggerContext":{"timeContext":{"frequency":"DAILY"}}}}}}} [32m+0ms[0m
      âœ“ Should return valid JSON update registration request
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskToRegisterDailyUpdate: intent=, intentArguments=[object Object], dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Name of intent to trigger on update must be specified [32m+0ms[0m
      âœ“ Should return null
    #isUpdateRegistered
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"REGISTER_UPDATE","extension":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValue","status":"OK"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+1ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misUpdateRegistered [32m+0ms[0m
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"name":"REGISTER_UPDATE","extension":{"@type":"type.googleapis.com/google.actions.v2.RegisterUpdateValue","status":"CANCELLED"}}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0misPermissionGranted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetArgument: argName=permission_granted [32m+0ms[0m
  [32;1mactions-on-google:debug [0mFailed to get argument value: permission_granted [32m+0ms[0m
      âœ“ Should validate user registration status.
    #askForUpdatePermission
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=test_intent, intentArguments=[object Object], dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}} [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_PERMISSION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent","arguments":[{"name":"intent_name","textValue":"intent_value"}]}}}}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+1ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=test_intent, intentArguments=undefined, dialogState=undefined [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillPermissionsRequest_: permissionsSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}} [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mfulfillSystemIntent_: intent=actions.intent.PERMISSION, specType=type.googleapis.com/google.actions.v2.PermissionValueSpec, intentSpec={"permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}, promptPlaceholder=PLACEHOLDER_FOR_PERMISSION dialogState=undefined [31m+0ms[0m
  [31;1mactions-on-google:debug [0mbuildResponse_: textToSpeech=PLACEHOLDER_FOR_PERMISSION, expectUserResponse=true, noInputs=undefined [31m+0ms[0m
  [32;1mactions-on-google:debug [0misSsml_: text=PLACEHOLDER_FOR_PERMISSION [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0mdoResponse_: response={"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}}}}}, responseCode=200 [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mResponse {"speech":"PLACEHOLDER_FOR_PERMISSION","contextOut":[{"name":"_actions_on_google_","lifespan":100,"parameters":{}}],"data":{"google":{"expectUserResponse":true,"noInputPrompts":[],"isSsml":false,"userStorage":"{\"data\":{}}","systemIntent":{"intent":"actions.intent.PERMISSION","data":{"@type":"type.googleapis.com/google.actions.v2.PermissionValueSpec","permissions":["UPDATE"],"updatePermissionValueSpec":{"intent":"test_intent"}}}}}} [32m+0ms[0m
      âœ“ Should return the valid JSON in the response object without arguments for the success case.
  [31;1mactions-on-google:debug [0mDialogflowApp constructor [31m+0ms[0m
  [32;1mactions-on-google:debug [0mAssistantApp constructor [32m+0ms[0m
  [32;1mactions-on-google:debug [0mRequest from Assistant: {"lang":"en","status":{"errorType":"success","code":200},"timestamp":"2017-01-01T12:00:00","sessionId":"0123456789101112","result":{"parameters":{"city":"Rome","name":"Ana"},"contexts":[],"resolvedQuery":"my name is Ana and I live in Rome","source":"agent","score":1,"speech":"","fulfillment":{"messages":[{"speech":"Hi Ana! Nice to meet you!","type":0}],"speech":"Hi Ana! Nice to meet you!"},"actionIncomplete":false,"action":"greetings","metadata":{"intentId":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","webhookForSlotFillingUsed":"false","intentName":"greetings","webhookUsed":"true"}},"id":"1a2b3c4d-5e6f-7g8h-9i10-11j12k13l14m15n16o","originalRequest":{"source":"google","data":{"inputs":[{"raw_inputs":[{"query":"my name is Ana and I live in Rome","input_type":2}],"intent":"assistant.intent.action.TEXT","arguments":[{"text_value":"my name is Ana and I live in Rome","raw_text":"my name is Ana and I live in Rome","name":"text"}]}],"user":{"user_id":"user123","locale":"en-US"},"conversation":{"conversation_id":"0123456789","type":2,"conversation_token":"[]"}}}} [32m+0ms[0m
  [32;1mactions-on-google:debug [0mActions API version from header: 2 [32m+1ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [31;1mactions-on-google:debug [0mextractData_ [31m+0ms[0m
  [32;1mactions-on-google:debug [0misNotApiVersionOne_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mextractUserStorage_ [32m+0ms[0m
  [32;1mactions-on-google:debug [0mgetUser [32m+0ms[0m
  [32;1mactions-on-google:debug [0maskForUpdatePermission: intent=, intentArguments=[object Object], dialogState=undefined [32m+0ms[0m
  [32;1mactions-on-google:debug [0mhandleError_: text=Name of intent to trigger on update must be specified [32m+0ms[0m
      âœ“ Should return null

  RichResponse
    #constructor
      âœ“ should create valid object
    #addSimpleResponse
      âœ“ should add a simple response w/ just speech
      âœ“ should add a simple response w/ just SSML speech
      âœ“ should add a simple response w/ just whitespace padded SSML speech
      âœ“ should add a simple response w/ speech and display text
      âœ“ should add a simple response w/ SSML speech and display text
      âœ“ should add a simple response w/ whitespace padded SSML speech and display text
      âœ“ not add more than two simple responses
      âœ“ should replace a basic card at first position
      âœ“ should replace a structured response at first position
    #addOrderUpdate
      âœ“ should add an order update
      âœ“ should not add more than one order update
    #addBasicCard
      âœ“ should add a basic card
      âœ“ should not add more than one basic card
    #addSuggestions
      âœ“ should add a single suggestion
      âœ“ should add multiple suggestions
      âœ“ should not add a suggestion longer than 25 characters
    #addSuggestionLink
      âœ“ should add a single suggestion link
      âœ“ should replace existing suggestion link

  BasicCard
    #constructor
      âœ“ should create valid object
    #setTitle
      âœ“ should set title
      âœ“ should overwrite previously set title
    #setSubtitle
      âœ“ should set subtitle
      âœ“ should overwrite previously set subtitle
    #setBodyText
      âœ“ should set body text
      âœ“ should overwrite previously set body text
    #setImage
      âœ“ should set image
      âœ“ should overwrite previously set image
    #setImageDisplay
      âœ“ constructor should have undefined image options
      âœ“ should ignore invalid image display option
      âœ“ should set image display options
      âœ“ should overwrite previously set image display
    #addButton
      âœ“ should add a single button
      âœ“ should add multiple buttons

  List
    #constructor
      âœ“ should create valid object
    #setTitle
      âœ“ should set title
      âœ“ should overwrite previously set title
    #addItems
      âœ“ should add a single item
      âœ“ should add multiple items
      âœ“ should add no more than 30 items

  Carousel
    #constructor
      âœ“ should create valid object
    #addItems
      âœ“ should add a single item
      âœ“ should add multiple items
      âœ“ should add no more than 10 items

  OptionItem
    #constructor
      âœ“ should create valid object
    #setTitle
      âœ“ should set title
      âœ“ should overwrite previously set title
    #setDescription
      âœ“ should set subtitle
      âœ“ should overwrite previously set description
    #setImage
      âœ“ should set image
      âœ“ should overwrite previously set image

  Order
    #constructor
      âœ“ should create valid object
    #setCart
      âœ“ should set the cart
      âœ“ should overwrite previously set cart
    #addOtherItems
      âœ“ should add a single other item
      âœ“ should add multiple other items
    #setImage
      âœ“ should set the image
      âœ“ should overwrite previously set image
    #setTOS
      âœ“ should set the TOS
      âœ“ should overwrite previously set TOS
    #setTotalPrice
      âœ“ should set the price
      âœ“ should overwrite previously set price
    #setTime
      âœ“ should set the time
      âœ“ should overwrite the previously set time
    #addLocation
      âœ“ should add one location
      âœ“ should add a second location
      âœ“ should not add a third location

  Cart
    #constructor
      âœ“ should create valid object
    #setMerchant
      âœ“ should set the merchant
      âœ“ should overwrite previously set merchant
    #setNotes
      âœ“ should set the notes
      âœ“ should overwrite previously set notes
    #addLineItems
      âœ“ should add a single other item
      âœ“ should add multiple other items
    #addOtherItems
      âœ“ should add a single other item
      âœ“ should add multiple other items

  LineItem
    #constructor
      âœ“ should create valid object
    #addSublines
      âœ“ should add a single subline
      âœ“ should add multiple sublines
      âœ“ should add a single string subline
      âœ“ should add multiple string sublines
      âœ“ should add multiple string and object sublines
    #setImage
      âœ“ should set the image
      âœ“ should overwrite previously set image
    #setPrice
      âœ“ should set the price
      âœ“ should overwrite previously set price
    #setType
      âœ“ should set the type
      âœ“ should overwrite previously set type
    #setQuantity
      âœ“ should set the quantity
      âœ“ should overwrite previously set quantity
    #setDescription
      âœ“ should set the description
      âœ“ should overwrite previously set description
    #setOfferId
      âœ“ should set the offerId
      âœ“ should overwrite previously set offerId

  OrderUpdate
    #constructor
      âœ“ should create valid object with Google order ID
      âœ“ should create valid object with Action order ID
    #setTotalPrice
      âœ“ should set the price
      âœ“ should overwrite previously set price
    #setOrderState
      âœ“ should set the state
      âœ“ should overwrite previously set state
    #setUpdateTime
      âœ“ should set the update time
      âœ“ should overwrite previously set update time
      âœ“ should round down the nanosecond field to the nearest millisecond
    #setUserNotification
      âœ“ should set the user notification
      âœ“ should overwrite previously set user notification
    #addOrderManagementAction
      âœ“ should add order management actions
    #setInfo
      âœ“ should set the order update info
      âœ“ should override previously set order update info
      âœ“ should recognize invalid update info types
    #addLineItemPriceUpdate
      âœ“ should add a new update for line item
      âœ“ should fail for new item update without reason
      âœ“ should append price update for existing line item
      âœ“ should fail to update price for existing line item without reason
    #addLineItemStateUpdate
      âœ“ should add a new update for line item
      âœ“ should succeed for new item update without reason
      âœ“ should append state update for existing line item
      âœ“ should succeed to update state for existing line item without reason

  transformToSnakeCase
    âœ“ Converts camelCase object to snake_case
    âœ“ Leaves the original object untouched
    âœ“ Does not convert incoming function to object
    âœ“ Does not convert incoming null to object

  transformToCamelCase
    âœ“ Converts snake object to camelCase
    âœ“ Leaves the original object untouched
    âœ“ Does not convert incoming function to object
    âœ“ Does not convert incoming null to object


  367 passing (333ms)
  2 failing

  1) ActionsSdkApp #getProfile Should resolve when the ID Token is present:
     TypeError: Cannot read property 'user' of undefined
      at Context.<anonymous> (test/actions-sdk-app-test.js:3173:11)

  2) ActionsSdkApp #getProfile Should resolve immediately when called >1 times:
     TypeError: Cannot read property 'user' of undefined
      at Context.<anonymous> (test/actions-sdk-app-test.js:3186:11)



